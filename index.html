<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>moro0204</title>
  


  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <!-- <meta name="viewport" content="width=device-width,initial-scale=1"> -->


  <meta name="theme-color" content="#fffbbd"/>
  <meta name="apple-touch-fullscreen" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-title" content="your_title">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="robots" content="noodp ,NOINDEX , NOFOLLOW"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />

  <link rel="stylesheet" href="/moro/reset.css">  
  <link rel="stylesheet" href="/moro/style.css">


  <link rel="apple-touch-icon" href="/moro/icon/16.png" sizes="16x16">
  <link rel="apple-touch-icon" href="/moro/icon/20.png" sizes="20x20">
  <link rel="apple-touch-icon" href="/moro/icon/24.png" sizes="24x24">
  <link rel="apple-touch-icon" href="/moro/icon/29.png" sizes="29x29">
  <link rel="apple-touch-icon" href="/moro/icon/32.png" sizes="32x32">
  <link rel="apple-touch-icon" href="/moro/icon/40.png" sizes="40x40">
  <link rel="apple-touch-icon" href="/moro/icon/48.png" sizes="48x48">
  <link rel="apple-touch-icon" href="/moro/icon/50.png" sizes="50x50">
  <link rel="apple-touch-icon" href="/moro/icon/57.png" sizes="57x57">
  <link rel="apple-touch-icon" href="/moro/icon/64.png" sizes="64x64">	
  <link rel="apple-touch-icon" href="/moro/icon/72.png" sizes="72x72">
  <link rel="apple-touch-icon" href="/moro/icon/114.png" sizes="114x114">
  <link rel="apple-touch-icon" href="/moro/icon/120.png" sizes="120x120">
  <link rel="apple-touch-icon" href="/moro/icon/128.png" sizes="128x128">
  <link rel="apple-touch-icon" href="/moro/icon/144.png" sizes="144x144">
  <link rel="apple-touch-icon" href="/moro/icon/192.png" sizes="192x192">
  <link rel="apple-touch-icon" href="/moro/icon/256.png" sizes="256x256">
  <link rel="apple-touch-icon" href="/moro/icon/512.png" sizes="512x512">
      <!-- Add to splash screen for Safari on iOS -->

<link href="/moro/screen/iphone5_splash.png" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
<link href="/moro/screen/iphone6_splash.png" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
<link href="/moro/screen/iphoneplus_splash.png" media="(device-width: 621px) and (device-height: 1104px) and (-webkit-device-pixel-ratio: 3)" rel="apple-touch-startup-image" />
<link href="/moro/screen/iphonex_splash.png" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3)" rel="apple-touch-startup-image" />
<link href="/moro/screen/iphonexr_splash.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
<link href="/moro/screen/iphonexsmax_splash.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3)" rel="apple-touch-startup-image" />
<link href="/moro/screen/ipad_splash.png" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
<link href="/moro/screen/ipadpro1_splash.png" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
<link href="/moro/screen/ipadpro3_splash.png" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
<link href="/moro/screen/ipadpro2_splash.png" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />


<!--
  
      <link rel="apple-touch-startup-image" href="/screen/320x568.png">
      <link rel="apple-touch-startup-image" href="/screen/360x640.png">
      <link rel="apple-touch-startup-image" href="/screen/360x800.png">
      <link rel="apple-touch-startup-image" href="/screen/375x667.png">
      <link rel="apple-touch-startup-image" href="/screen/375x812.png">
      <link rel="apple-touch-startup-image" href="/screen/383x812.png">
      <link rel="apple-touch-startup-image" href="/screen/390x844.png">
      <link rel="apple-touch-startup-image" href="/screen/414x736.png">
      <link rel="apple-touch-startup-image" href="/screen/414x986.png">
      <link rel="apple-touch-startup-image" href="/screen/428x926.png">
      <link rel="apple-touch-startup-image" href="/screen/640x960.png">
      <link rel="apple-touch-startup-image" href="/screen/640x1136.png">
      <link rel="apple-touch-startup-image" href="/screen/744x1133.png">
    
      <link rel="apple-touch-startup-image" href="/screen/750x1334.png">
      <link rel="apple-touch-startup-image" href="/screen/768x1024.png">
      <link rel="apple-touch-startup-image" href="/screen/834x1194.png">
      <link rel="apple-touch-startup-image" href="/screen/960x1440.png">
      <link rel="apple-touch-startup-image" href="/screen/1024x768.png">
      <link rel="apple-touch-startup-image" href="/screen/1024x1366.png">
      <link rel="apple-touch-startup-image" href="/screen/1125x2436.png">
      <link rel="apple-touch-startup-image" href="/screen/1242x2208.png">
    
      <link rel="apple-touch-startup-image" href="/screen/1242x2688.png">
      <link rel="apple-touch-startup-image" href="/screen/1536x2048.png">
      <link rel="apple-touch-startup-image" href="/screen/1668x2224.png">
      <link rel="apple-touch-startup-image" href="/screen/2048x1536.png">
      <link rel="apple-touch-startup-image" href="/screen/2048x2732.png">
      <link rel="apple-touch-startup-image" href="/screen/2208x1242.png">
      <link rel="apple-touch-startup-image" href="/screen/2224x1668.png">
    
    
      <link rel="apple-touch-startup-image" href="/screen/640x1136.png" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)" and (orientation: any)"> 
      <link rel="apple-touch-startup-image" href="/screen/750x1334.png" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2)" and (orientation: any)"> 
      <link rel="apple-touch-startup-image" href="/screen/1242x2208.png" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3)" and (orientation: any)">
      <link rel="apple-touch-startup-image" href="/screen/1125x2436.png" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3)" and (orientation: any)"> 
      <link rel="apple-touch-startup-image" href="/screen/1536x2048.png" media="(min-device-width: 768px) and (max-device-width: 1024px) and (-webkit-min-device-pixel-ratio: 2)" and (orientation: any)">
      <link rel="apple-touch-startup-image" href="/screen/1668x2224.png" media="(min-device-width: 834px) and (max-device-width: 834px) and (-webkit-min-device-pixel-ratio: 2)" and (orientation: any)"> 
      <link rel="apple-touch-startup-image" href="/screen/2048x2732.png" media="(min-device-width: 1024px) and (max-device-width: 1024px) and (-webkit-min-device-pixel-ratio: 2) " and (orientation: any)"> 
      
-->




  
  <link rel="icon" href="/moro/icon/favicon.ico"><!-- 512×512 -->
  <!-- <link rel="icon" href="/moro/icon/lip_gakua_icon.svg" type="image/svg+xml"> -->
  <link rel="apple-touch-icon" href="/moro/icon/apple-touch-icon.png">





</head>
<body>
  <div class="komento1">パックテスト</div>
  <div class="komento2">色見本と推定Ver.Moro</div>
  <div class="flex_test-box">
    <div class="flex_test-itembox">
        1.コンテンツが入ります。

        <!-- <img src="n_sample_tate.png" alt="架空のサンプル" width="100px" > --> <!-- height="200px"> --> 
      <div class="sample1">100</div>
      <div class="sample1">50</div>
      <div class="sample1">20</div>
      <div class="sample1">13</div>
      <div class="sample1">10</div>
      <div class="sample1">5</div>
      <div class="sample1">0</div>
      <div class="sample1"></div>  
    
    
    
    
      </div>
    
      <div class="flex_test-itembox">
        <p><br><br><br><br><br><br><br><br><br><br><br><br></p>






        2.コンテンツが入ります。コンテンツが入ります。
        <style>
          canvas, video{
            border: 1px solid gray;
          }
          </style>
          <h1>色から推定20230206</h1>

          <video id="camera" width="150" height="150"></video>

          <form>
            <button type="button" id="shutter">シャッター</button>
          </form>
          <h1>↓RGB値を取得したいところをタップ↓</h1>


          <canvas id="MyCanvas" width="150" height="150"></canvas>

          <div id="msg"></div>
          <div id="cal"></div>
          <div id="s_rg"></div>
          <div id="s_gb"></div>
          <div id="s_ba"></div>
          <div id="s_ar"></div>






          <audio id="se" preload="auto">
            <source src="/moro/oto.mp3" type="audio/mp3">
          </audio>

          <script>
            // manifestのlinkタグを生成
            function setManifest(path) {
              const manifest = document.createElement('link');
              manifest.rel = 'manifest';
              manifest.href = path;
              document.head.appendChild(manifest);
            }
        
            // OSに応じて読み込むmanifestを変更
            var userAgent = navigator.userAgent.toLowerCase();
            if (userAgent.indexOf("iphone") > 0 || userAgent.indexOf("ipad") > 0) {
              setManifest('/moro/manifest_ios.json')
            } else {
              setManifest('/moro/manifest.json')
            }
            </script>  

          <script>
          window.onload = () => {
            const video  = document.querySelector("#camera");
            const canvas = document.querySelector("#MyCanvas");
            const se     = document.querySelector('#se');

            /** カメラ設定 */
            const constraints = {
              audio: false,
              video: {
                width: 150,
                height: 150,
                //facingMode: "user"   // フロントカメラを利用する
                facingMode: { exact: "environment" }  // リアカメラを利用する場合
              }
            };

            /**
             * カメラを<video>と同期
             */
            navigator.mediaDevices.getUserMedia(constraints)
            .then( (stream) => {
              video.srcObject = stream;
              video.onloadedmetadata = (e) => {
                video.play();
              };
            })
            .catch( (err) => {
              console.log(err.name + ": " + err.message);
            });

            /**
             * シャッターボタン
             */
            document.querySelector("#shutter").addEventListener("click", () => {
              const ctx = canvas.getContext("2d");

              // 演出的な目的で一度映像を止めてSEを再生する
              video.pause();  // 映像を停止
              se.play();      // シャッター音
              setTimeout( () => {
                video.play();    // 0.5秒後にカメラ再開
              }, 500);

              // canvasに画像を貼り付ける
              ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
            });
          };

          
            // RGBから#ffffff形式へ変換する
            function RGB2bgColor(r,g,b) {
          
              r = r.toString(16);
              if (r.length == 1) r = "0" + r;
          
              g = g.toString(16);
              if (g.length == 1) g = "0" + g;
          
              b = b.toString(16);
              if (b.length == 1) b = "0" + b;
          
              return '#' + r + g + b;  
            }  
            
            var canvas = document.getElementById("MyCanvas");
            
            if (canvas.getContext) {
              // コンテキストの取得
              var ctx = canvas.getContext("2d");                
              var image = document.getElementById("MyCanvas");
          
              image.onload = function () {
                
                // キャンバスをクリア
                ctx.clearRect(0, 0, canvas.width, canvas.height); 
                
                // キャンバスの中心に画像を描画
                var x = (canvas.width - image.width) / 2;
                var y = (canvas.height - image.height) / 2;      
                ctx.drawImage(image, x, y);
              };
            }
          
            canvas.onclick = function(evt){
            
              //  マウス座標の取得
              var x = parseInt(evt.offsetX);
              var y = parseInt(evt.offsetY);
          
              //  指定座標のImageDataオブジェクトの取得 
              var imagedata = ctx.getImageData(x, y, 1, 1);
          
              //  RGBAの取得
              var r = imagedata.data[0];        
              var g = imagedata.data[1];
              var b = imagedata.data[2];
              var a = imagedata.data[3];
              
              var r_g = r-g;
              //var gb = g+b;
              //var ba = b+a;
              //var ar = a+r;

              var kisyaku5 = (-1.07*r_g)+57
              var kisyaku8 =(-1.71*r_g)+114


              canvas.style.backgroundColor = RGB2bgColor(r,g,b);
              document.getElementById("msg").innerHTML = 
                "Red: " + r + "  Green: " + g + "  Blue: " + b + "  Alpha: " + a;    

              //document.getElementById("cal").innerHTML = 
              //  " R+G:" + rg + " G+B:" + gb + " R+G:" + ba + " A+R:" + ar;  
              
              document.getElementById("s_rg").innerHTML = 
                "5倍希釈の場合（mg/㎏）: " + kisyaku5;  
              
              document.getElementById("s_gb").innerHTML = 
                "8倍希釈の場合（mg/㎏）: " + kisyaku8;  

              //document.getElementById("s_ba").innerHTML = 
              //  "R+G(RとGの合計): " + ba;  

              //document.getElementById("s_ar").innerHTML = 
              //  "A+R(AとRの合計): " + ar;  
            }





  
</script>

    </div>
    
    <div class="flex_test-itembox">
        3.コンテンツが入ります。  
                <!-- <img src="n_sample_tate.png" alt="架空のサンプル" width="100px" > --> <!-- height="200px"> --> 
      <div class="sample2"></div>
      <div class="sample2">0</div>
      <div class="sample2">5</div>
      <div class="sample2">10</div>
      <div class="sample2">13</div>
      <div class="sample2">20</div>
      <div class="sample2">50</div>
      <div class="sample2">100</div>      
    
    
    
    
      </div>
    </div>
    <div class="komento3">2023年2月6日</div>
    <div class="komento4">もろもろもろもろ</div>

    <script>

      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('serviceWorker.js').then(reg => {
        console.log('サービスワーカーを登録しました', reg);
        }).catch(err => {
        console.log('登録失敗', err);
        });
      }
    </script>

    </body>